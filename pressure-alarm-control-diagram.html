<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pressure Alarm Control Diagram</title>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
    <style>
        .legend {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .legend div {
            display: flex;
            align-items: center;
        }
        .color-box {
            width: 20px;
            height: 20px;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="mermaid">
        graph TD
            A[Room101_DP<br/>Out: 0.025 float ok]:::input -->|Input| B[AHU_Status<br/>Status: OK]:::boolean
            A -->|Input| C[OccSchedule<br/>Status: Occupied]:::boolean
            B -->|Output| D[DP_Setpoint<br/>Value: 22.5 float writable]:::numericWritable
            D -->|Offset| E[HighOffset<br/>Value: 2.0 float ok]:::numeric
            D -->|Offset| F[LowOffset<br/>Value: -2.0 float ok]:::numeric
            F -->|Add| G[AddHigh<br/>Output: 24.5 float ok]:::add
            E -->|Add| H[AddLow<br/>Output: 20.5 float ok]:::add
            G -->|Trigger| I[HighAlarm_Occ<br/>Alarm Triggered]:::highAlarm
            H -->|Trigger| J[LowAlarm_Occ<br/>Alarm Triggered]:::lowAlarm
            I -->|Logic| K[SignChange<br/>Status: Change Detected]:::logic
            K -->|Status| L[DirectionAlarm<br/>Status: Alarm Active]:::booleanAlarm
            J -->|Logic| M[Delay_5Min<br/>Status: Delayed]:::delay
            M -->|Trigger| N[Timer_30Min<br/>Status: Timer Active]:::timer
            N -->|Override| O[AHU_Override<br/>Status: Overridden]:::booleanWritable
            O -->|Select| P[ModeSelect<br/>Status: Mode Selected]:::or
            P -->|Switch| Q[AlarmMux<br/>Status: Mux Active]:::switch
            Q -->|Output| R[FinalAlarm<br/>Status: Alarm Triggered]:::boolean

        classDef input fill:#6B9BD1;
        classDef numeric fill:#6B9BD1;
        classDef boolean fill:#9B7BC6;
        classDef numericWritable fill:#9B7BC6;
        classDef highAlarm fill:#E85D5D;
        classDef lowAlarm fill:#E85D5D;
        classDef logic fill:#FFB84D;
        classDef booleanAlarm fill:#E85D5D;
        classDef delay fill:#6B6B8B;
        classDef timer fill:#6B6B8B;
        classDef add fill:#FFB84D;
        classDef or fill:#7BC67B;
        classDef switch fill:#7BC67B;
        
    </div>
    <div class="legend">
        <div><div class="color-box" style="background-color: #6B9BD1;"></div>Input Points</div>
        <div><div class="color-box" style="background-color: #9B7BC6;"></div>Setpoints</div>
        <div><div class="color-box" style="background-color: #FFB84D;"></div>Logic/Math</div>
        <div><div class="color-box" style="background-color: #E85D5D;"></div>Alarms</div>
        <div><div class="color-box" style="background-color: #7BC67B;"></div>Control Logic</div>
        <div><div class="color-box" style="background-color: #6B6B8B;"></div>Timers</div>
    </div>
    <button onclick="zoomIn()">Zoom In</button>
    <button onclick="zoomOut()">Zoom Out</button>
    <button onclick="resetZoom()">Reset Zoom</button>
    <button onclick="exportToPNG()">Export to PNG</button>
    <script>
        function zoomIn() {
            // Implement zoom in functionality
        }
        function zoomOut() {
            // Implement zoom out functionality
        }
        function resetZoom() {
            // Implement reset zoom functionality
        }
        function exportToPNG() {
            // Implement export to PNG functionality using html2canvas
        }
    </script>
</body>
</html>
